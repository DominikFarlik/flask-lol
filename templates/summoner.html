{% extends 'base.html' %}
{% block title %}Summoner{% endblock %}
{% block background_image %}<img class="" src="https://ddragon.leagueoflegends.com/cdn/img/champion/centered/Ekko_19.jpg">{% endblock %}
{% block body %}
    {% if errors.player_data_error %}
        <p>{{ errors.player_data_error }}</p>
    {% else %}
        <div class="horizontal-header-container">
            <div class="profile-icon-container">
                <div class="level-header">{{ data.summonerLevel }}</div>
                <img class="profile-icon-image" src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/profileicon/{{ data.profileIconId }}.png">
            </div>
            <div class="header-vertical-container">
                <span class="summoner-name-header">{{ data.gameName }} #{{ data.tagLine }}</span>
                <form action="{{ url_for('update_summoner', summoner_name=data.gameName + ' #' + data.tagLine) }}"
                      method="post">
                    <button type="submit" class="update-button">Update</button>
                </form>
            </div>
        </div>

        <div class="horizontal-body-container">
        <div class="vertical-container">
            {% if errors.rank_error %}
                <p>{{ errors.rank_error }}</p>
            {% else %}
                {% if data.ranked_solo %}
                    <div class="rank-container">
                        <span class="rank-name">Ranked Solo</span>
                        <img style="width: 100px; height: 100px" src="{{ url_for('static', filename='/ranked-emblems/{}.png'.format(data.ranked_solo.tier)) }}">
                        <span class="main-rank-stats">{{ data.ranked_solo.tier }} {{ data.ranked_solo.rank }} {{ data.ranked_solo.leaguePoints }} LP </span>
                        <span>{{ data.ranked_solo.wins }} W  {{ data.ranked_solo.losses }} L</span>
                        <span>{{ data.ranked_solo.winrate }} % Win rate</span>
                    </div>
                {% endif %}
                {% if data.ranked_flex %}
                    <div class="rank-container">
                        <span class="rank-name">Ranked Flex</span>
                        <img style="width: 100px; height: 100px" src="{{ url_for('static', filename='/ranked-emblems/{}.png'.format(data.ranked_flex.tier)) }}" alt="data.ranked_flex.tier">
                        <span class="main-rank-stats">{{ data.ranked_flex.tier }} {{ data.ranked_flex.rank }} {{ data.ranked_flex.leaguePoints }} LP </span>
                        <span>{{ data.ranked_flex.wins }} W {{ data.ranked_flex.losses }} L</span>
                        <span>{{ data.ranked_flex.winrate }} % Win rate</span>
                    </div>
                {% endif %}
            {% endif %}
        </div>
        <div class="match-history">
            {% if errors.match_history_error %}
                {{ errors.match_history_error }}
            {% else %}
                {% for match in data.match_history %}
                    {% for row in match.info.participants %}
                        {% if row.puuid == puuid %}
                            {% if row.win %}
                                <div class="match-history-row-win">
                            {% else %}
                                <div class="match-history-row-lose">
                            {% endif %}
                        <div class="first-column">
                            <div style="font-size: 13px; font-weight: 700">{{ match.info.queueName }}</div>
                            <div>{{ match.info.gameEndTimestamp }}</div>
                            <div>{{ match.info.gameDuration }}</div>
                        </div>
                        <div class="champion">
                            <div class="champion-face">
                                <img class="champion-img"
                                     src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/champion/{{ row.championName }}.png"
                                     alt="{{ row.championName }}">
                                <div class="champion-level">{{ row.champLevel }}</div>
                            </div>
                        </div>
                        <div class="summoner-spells">
                            <img class="summoner-spell"
                                 src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/spell/{{ row.summoner1Name }}.png"
                                 alt="{{ row.summoner1Name }}">
                            <img class="summoner-spell"
                                 src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/spell/{{ row.summoner2Name }}.png"
                                 alt="{{ row.summoner2Name }}">
                        </div>
                        <div class="post-game-stats">
                            <span class="main-stats">{{ row.kills }}/{{ row.deaths }}/{{ row.assists }}</span>
                            <span>{{ row.kda }} KDA</span>
                            <span>{{ row.totalMinionsKilled + row.neutralMinionsKilled }} CS</span>
                        </div>
                        <div class="items">
                            <div class="main-items">
                                {% for item_num in range(6) %}
                                {% if row['item{}'.format(item_num)] %}
                                    <img class="item" src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/item/{{ row['item{}'.format(item_num)] }}.png" alt="item">
                                {% else %}
                                    <div class="blank-item"></div>
                                {% endif %}
                            {% endfor %}
                            </div>
                            <div class="trinket">
                                <img class="item" src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/item/{{ row.item6 }}.png" alt="item">
                            </div>
                        </div>
                        <div>
                            <div class="players">
                                <div class="team-list">
                                    {% for participant in match.info.participants %}
                                        {% if participant.teamId == 100 %}
                                            <div class="player">
                                                <img class="player-champion" src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/champion/{{ participant.championName }}.png" alt="item">
                                                <a href="{{ url_for('summoner', summoner_name=participant.riotIdGameName + ' #' + participant.riotIdTagline) }}">{{ participant.riotIdGameName }}</a>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <div class="team-list">
                                    {% for participant in match.info.participants %}
                                        {% if participant.teamId == 200 %}
                                            <div class="player">
                                                <img class="player-champion" src="https://ddragon.leagueoflegends.com/cdn/14.8.1/img/champion/{{ participant.championName }}.png" alt="item">
                                                <a href="{{ url_for('summoner', summoner_name=participant.riotIdGameName + ' #' + participant.riotIdTagline) }}">{{ participant.riotIdGameName }}</a>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            {% endif %}
            </div>
        </div>
    {% endif %}
{% endblock %}